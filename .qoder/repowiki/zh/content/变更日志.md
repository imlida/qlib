# 变更日志

<cite>
**本文档中引用的文件**  
- [CHANGES.rst](file://CHANGES.rst)
- [docs/changelog/changelog.rst](file://docs/changelog/changelog.rst)
- [pyproject.toml](file://pyproject.toml)
- [README.md](file://README.md)
- [.commitlintrc.js](file://.commitlintrc.js)
</cite>

## 目录
1. [简介](#简介)
2. [重大版本变更](#重大版本变更)
3. [次要版本功能](#次要版本功能)
4. [补丁修复](#补丁修复)
5. [版本控制规范](#版本控制规范)
6. [参考链接](#参考链接)

## 简介
QLib是一个面向人工智能的量化投资平台，旨在通过AI技术实现量化投资的潜力、赋能研究并创造价值。本变更日志文档记录了QLib每个版本的功能更新、bug修复和破坏性变更，遵循语义化版本控制规范，帮助用户评估升级影响。

**Section sources**
- [README.md](file://README.md#L82-L87)

## 重大版本变更
重大版本变更引入了破坏性变更和架构重构，对系统核心组件进行了重大改进。

### 版本 0.8.0
- 对回测模块进行了大规模重构
- 支持嵌套决策执行框架
- 交易限制在做多和做空操作之间更加精确
- 计算年化指标时使用了更准确的常数
- 发布了新版本的数据集

### 版本 0.5.0
- 首个开源版本发布
- 优化了文档和代码
- 添加了基线模型
- 发布了公共数据爬虫

### 版本 0.4.0
- 添加了`data`包，集中管理所有数据相关代码
- 重构了数据提供者结构
- 创建了用于数据集中管理的服务器`qlib-server`
- 添加了可插拔的缓存机制
- 添加了递归回溯算法来检查表达式的最远引用日期

### 版本 0.3.5
- 支持多标签训练，可以在`handler`中提供多个标签
- 重构了`handler`代码，不再使用dataset.py
- 处理程序仅提供DataFrame
- 将数据滚动改为基于市场日历而非普通日期

**Section sources**
- [CHANGES.rst](file://CHANGES.rst#L155-L173)
- [CHANGES.rst](file://CHANGES.rst#L78-L83)

## 次要版本功能
次要版本添加了新功能和特性，增强了平台的功能性。

### 版本 0.4.5
- 为客户端和服务器添加了多内核实现
- 支持跳过数据集缓存的新数据加载方式
- 默认数据集方法从单内核实现改为多内核实现
- 通过优化相关模块加速高频数据读取
- 支持使用字典写入配置文件的新方法

### 版本 0.4.3
- 实现了在线推理和交易框架
- 重构了回测和策略模块的接口

### 版本 0.4.2
- 重构了DataHandler
- 添加了`Alpha360` DataHandler

### 版本 0.4.1
- 添加了对Windows系统的支持

### 版本 0.2.2
- 为特征重用添加了`disk_cache`
- 添加了`qlib.contrib`用于实验性模型构建和评估

### 版本 0.2.1
- 支持注册用户自定义的`Provider`
- 支持在字符串格式中使用操作符，如`['Ref($close, 1)']`
- 支持`$some_field`格式的动态字段

### 版本 0.2.0
- 重新设计`LocalProvider`数据库格式以提高性能
- 支持将特征作为字符串字段加载
- 添加了数据库构建脚本

### 版本 0.1.2
- 支持操作符语法，现在`High() - Low()`等价于`Sub(High(), Low())`
- 添加了更多技术指标

**Section sources**
- [CHANGES.rst](file://CHANGES.rst#L140-L153)
- [CHANGES.rst](file://CHANGES.rst#L122-L123)
- [CHANGES.rst](file://CHANGES.rst#L116-L118)
- [CHANGES.rst](file://CHANGES.rst#L104-L111)
- [CHANGES.rst](file://CHANGES.rst#L37-L39)
- [CHANGES.rst](file://CHANGES.rst#L31-L33)
- [CHANGES.rst](file://CHANGES.rst#L24-L27)
- [CHANGES.rst](file://CHANGES.rst#L15-L17)

## 补丁修复
补丁版本主要修复了bug和稳定性问题。

### 版本 0.4.6
- 修复了`Version 0.4.5`中对日频数据不友好的默认配置问题
- 修复了当`WithInteract=True`时TopkWeightStrategy的回测错误

### 版本 0.4.4
- 修复了使用`ServerDatasetCache`离线时的bug
- 修复了`long_short_backtest`中可能出现`np.nan`的问题
- 重构了回测函数的参数

### 版本 0.4.1
- 修复了`instruments`类型bug
- 修复了`features`为空的bug（会导致更新失败）
- 修复了`cache`锁和更新bug
- 修复了为相同字段使用相同缓存的问题

### 版本 0.3.4
- 重构了`fetcher`代码

### 版本 0.3.3 和 0.3.2
- 修复了`filter`模块的bug

### 版本 0.3.2
- 修复了位置`amount`为0的bug

### 版本 0.1.3
- 修复了bug并添加了仪器过滤机制

**Section sources**
- [CHANGES.rst](file://CHANGES.rst#L149-L153)
- [CHANGES.rst](file://CHANGES.rst#L130-L138)
- [CHANGES.rst](file://CHANGES.rst#L105-L108)
- [CHANGES.rst](file://CHANGES.rst#L74-L75)
- [CHANGES.rst](file://CHANGES.rst#L69-L70)
- [CHANGES.rst](file://CHANGES.rst#L64-L65)
- [CHANGES.rst](file://CHANGES.rst#L20-L21)

## 版本控制规范
QLib遵循语义化版本控制规范，版本号格式为MAJOR.MINOR.PATCH，其中：

- MAJOR（重大）版本包含破坏性变更
- MINOR（次要）版本包含向后兼容的功能新增
- PATCH（补丁）版本包含向后兼容的bug修复

提交信息遵循约定式提交规范，使用以下类型：
- feat：新功能
- fix：bug修复
- docs：文档更新
- style：代码格式调整
- refactor：代码重构
- test：测试相关
- chore：构建过程或辅助工具的变动
- Release-As：版本发布

**Section sources**
- [.commitlintrc.js](file://.commitlintrc.js#L1-L21)
- [CHANGES.rst](file://CHANGES.rst#L5-L180)

## 参考链接
- [GitHub发布说明](https://github.com/microsoft/qlib/releases)
- [QLib文档](https://qlib.readthedocs.io/en/latest/)
- [RD-Agent项目](https://github.com/microsoft/RD-Agent)